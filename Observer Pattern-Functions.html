<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Observer Pattern with Button Clicks</title>
  </head>
  <body>
    <!-- You can add HTML elements such as buttons here -->
    <button id="button1">Button 1</button>
    <button id="button2">Button 2</button>
    <p id="output"></p>

    <!-- Coded with Javascript Design Patterns #5 - Observer Pattern https://www.youtube.com/watch?v=45TeJEmcqk8 -->
    <!-- Modified the code as inspired by  https://javascriptpatterns.vercel.app/patterns/design-patterns/observer-pattern -->

    <script>
      // Observer Pattern Implementation

      // Define a constructor function for the Subject object, that is, to represent the subject of the observer pattern

      function ButtonSubject() {
        this.observersList = []; // Array to hold observer functions
      }

      // Extend the prototype of the ButtonSubject object with methods subscribe, unsubscribe, and notify

      ButtonSubject.prototype = {
        // Method to subscribe an observer
        subscribe: function (observer) {
          this.observersList.push(observer);
        },
        // Method to unsubscribe an observer
        unsubscribe: function (observerToRemove) {
          // Remove the observerToRemove from the array by finding its index
          const index = this.observersList.indexOf(observerToRemove);
          if (index !== -1) {
            this.observersList.splice(index, 1);
          }
        },

        // Notification Process

        // Method to notify all observers
        notify: function (buttonId) {
          // Call each observer function based on the button clicked
          for (const observer of this.observersList) {
            observer(buttonId);
          }
        },
      };

      // Instantiate a new ButtonSubject object
      const buttonSubject = new ButtonSubject();

      // Notify Observers on Button Click

      // Function to handle button click events and notify observers
      function handleButtonClick(event) {
        buttonSubject.notify(event.target.id);
      }

      // Subscribe the observer functions to the buttonSubject
      buttonSubject.subscribe(function (buttonId) {
        switch(buttonId) {
          case "button1":
            document.getElementById("output").textContent =
              "Button Click Observer 1 is clicked!\n";
            break;
          case "button2":
            document.getElementById("output").textContent =
              "Button Click Observer 2 is clicked!\n";
            break;
        }
      });

      // Attach event listener to the buttons for click events
      document
        .getElementById("button1")
        .addEventListener("click", handleButtonClick);
      document
        .getElementById("button2")
        .addEventListener("click", handleButtonClick);
    </script>
  </body>
</html>
